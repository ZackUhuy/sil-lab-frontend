<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Admin Dashboard - SIL Lab</title>
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <style>
Â  Â  Â  Â  /* Gaya dasar untuk menyembunyikan konten tab */
Â  Â  Â  Â  .tab-content { display: none; }
Â  Â  Â  Â  .tab-content.active { display: block; }
Â  Â  Â  Â  /* Gaya tambahan untuk animasi modal yang lebih baik */
Â  Â  Â  Â  .modal { transition: opacity 0.25s ease; }
Â  Â  </style>
</head>
<body class="bg-gray-100 font-sans min-h-screen">

Â  Â  <nav class="bg-gray-900 p-4 text-white flex justify-between items-center shadow-lg sticky top-0 z-50">
Â  Â  Â  Â  <h1 class="font-bold text-xl tracking-wide">ADMIN PANEL SIL</h1>
Â  Â  Â  Â  <button onclick="logout()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm transition font-medium shadow">Keluar</button>
Â  Â  </nav>

Â  Â  <div class="container mx-auto p-6">
Â  Â  Â  Â  
Â  Â  Â  Â  <!-- Navigasi Tab -->
Â  Â  Â  Â  <div class="mb-6 bg-white rounded-lg shadow-sm p-1 flex space-x-1 flex-wrap md:flex-nowrap">
Â  Â  Â  Â  Â  Â  <button onclick="showTab('peminjaman')" id="tab-peminjaman" class="tab-button flex-1 py-3 px-4 rounded-md text-sm font-bold text-center bg-blue-600 text-white transition">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ“… Jadwal & Peminjaman
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button onclick="showTab('ruangan')" id="tab-ruangan" class="tab-button flex-1 py-3 px-4 rounded-md text-sm font-bold text-center text-gray-600 hover:bg-gray-100 transition">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ¢ Manajemen Ruangan
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button onclick="showTab('peralatan')" id="tab-peralatan" class="tab-button flex-1 py-3 px-4 rounded-md text-sm font-bold text-center text-gray-600 hover:bg-gray-100 transition">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ› ï¸ Manajemen Peralatan
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <!-- TAB BARU: LAPORAN KERUSAKAN -->
Â  Â  Â  Â  Â  Â  <button onclick="showTab('laporan')" id="tab-laporan" class="tab-button flex-1 py-3 px-4 rounded-md text-sm font-bold text-center text-gray-600 hover:bg-gray-100 transition mt-1 md:mt-0">
Â  Â  Â  Â  Â  Â  Â  Â  âš ï¸ Laporan Kerusakan
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- === TAB 1: MANAJEMEN JADWAL & PEMINJAMAN === -->
Â  Â  Â  Â  <div id="content-peminjaman" class="tab-content active">
Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <!-- FORM TAMBAH JADWAL MANUAL (KIRI) -->
Â  Â  Â  Â  Â  Â  Â  Â  <div class="lg:col-span-1 bg-white p-6 rounded-lg shadow h-fit border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold mb-4 text-gray-800 border-b pb-3">Tambah Jadwal Manual</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="form-tambah-jadwal" class="space-y-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Ruangan</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="jadwal_ruang_id" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Memuat...</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Mulai (Sesi 1)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="datetime-local" id="jadwal_mulai" class="w-full p-2 border rounded bg-gray-50 text-sm" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Selesai (Sesi 1)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="datetime-local" id="jadwal_selesai" class="w-full p-2 border rounded bg-gray-50 text-sm" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- FITUR ULANGI MINGGUAN -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-blue-50 p-3 rounded border border-blue-100">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" id="is_repeat" class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500 cursor-pointer" onchange="toggleRepeatInput()">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="is_repeat" class="ml-2 text-sm font-medium text-gray-700 cursor-pointer">Ulangi Jadwal (Mingguan)?</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="repeat_input_container" class="hidden mt-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Jumlah Minggu</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="repeat_count" class="w-full p-2 border rounded bg-white text-sm" value="16" min="2" max="20" placeholder="Contoh: 16">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-400 mt-1 italic">*Jadwal akan diduplikasi setiap 7 hari.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Keterangan Kegiatan</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="jadwal_tujuan" class="w-full p-2 border rounded bg-gray-50 text-sm" rows="2" placeholder="Contoh: Kuliah Algoritma A" required></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 font-medium shadow transition">Simpan Jadwal</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <!-- TABEL DAFTAR (KANAN) -->
Â  Â  Â  Â  Â  Â  Â  Â  <div class="lg:col-span-2 bg-white rounded-lg shadow overflow-hidden border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="p-4 border-b bg-gray-50 flex justify-between items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="font-bold text-gray-700">Daftar Request & Jadwal</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="loadAllBookings()" class="text-blue-600 text-sm hover:underline font-medium">ğŸ”„ Refresh</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="overflow-x-auto max-h-[600px]">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="min-w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="bg-gray-100 text-gray-600 text-xs uppercase sticky top-0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-left font-bold">User / Kegiatan</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-left font-bold">Info Waktu</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-center font-bold">Status</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-center font-bold">Aksi</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="adminTableBody" class="text-gray-600 text-sm divide-y divide-gray-100"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- === TAB 2: RUANGAN === -->
Â  Â  Â  Â  <div id="content-ruangan" class="tab-content">
Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="md:col-span-1 bg-white p-6 rounded-lg shadow h-fit border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold mb-4 text-gray-800 border-b pb-3">Tambah Ruangan</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="form-tambah-ruang" class="space-y-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Nama Ruang</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="nama_ruang" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Kapasitas</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="kapasitas" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Lokasi</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="lokasi" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 font-medium shadow">Simpan Ruangan</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="md:col-span-2 bg-white rounded-lg shadow overflow-hidden border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="min-w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="bg-gray-100 text-gray-600 text-xs uppercase">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-left font-bold">Ruangan</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-left font-bold">Status</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-center font-bold">Aksi</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="table-ruangan-body" class="text-gray-600 text-sm divide-y divide-gray-100"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- === TAB 3: PERALATAN === -->
Â  Â  Â  Â  <div id="content-peralatan" class="tab-content">
Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="md:col-span-1 bg-white p-6 rounded-lg shadow h-fit border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold mb-4 text-gray-800 border-b pb-3">Tambah Alat</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="form-tambah-peralatan" class="space-y-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Nama Alat</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="nama_alat" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Kategori</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="kategori" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Total</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="jumlah_total" class="w-full p-2 border rounded bg-gray-50" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Kondisi</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="kondisi" class="w-full p-2 border rounded bg-gray-50">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="baik">Baik</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="rusak">Rusak</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="maintenance">Maintenance</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-purple-600 text-white py-2 px-4 rounded hover:bg-purple-700 font-medium shadow">Simpan Alat</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="md:col-span-2 bg-white rounded-lg shadow overflow-hidden border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="min-w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="bg-gray-100 text-gray-600 text-xs uppercase">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-left font-bold">Nama Alat</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-left font-bold">Kategori</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-center font-bold">Total</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-center font-bold">Kondisi</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-6 text-center font-bold">Aksi</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="table-peralatan-body" class="text-gray-600 text-sm divide-y divide-gray-100"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- === TAB 4: LAPORAN KERUSAKAN BARU === -->
Â  Â  Â  Â  <div id="content-laporan" class="tab-content">
Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg shadow overflow-hidden border border-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="p-4 border-b bg-red-50 flex justify-between items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="font-bold text-red-700 flex items-center gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ğŸš¨ Daftar Laporan Kerusakan
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="loadLaporanKerusakan()" class="text-blue-600 text-sm hover:underline font-medium">ğŸ”„ Refresh</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="overflow-x-auto max-h-[600px]">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="min-w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="bg-gray-100 text-gray-600 text-xs uppercase sticky top-0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-left font-bold">Pelapor / Waktu</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-left font-bold">Item & Detail Kerusakan</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-center font-bold">Status</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="py-3 px-4 text-center font-bold">Aksi</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="table-laporan-body" class="text-gray-600 text-sm divide-y divide-gray-100">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- Data laporan akan dimuat di sini -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <!-- MODAL JADWAL -->
Â  Â  <div id="scheduleModal" class="hidden fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
Â  Â  Â  Â  <div class="absolute w-full h-full bg-gray-900 opacity-50" onclick="toggleModal()"></div>
Â  Â  Â  Â  <div class="bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-[80vh] p-6">
Â  Â  Â  Â  Â  Â  <div class="flex justify-between mb-4 border-b pb-2">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800" id="modalRoomName">Jadwal</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleModal()" class="text-gray-500 hover:text-red-500 font-bold">âœ•</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <ul id="modalScheduleList" class="space-y-2 text-sm"></ul>
Â  Â  Â  Â  Â  Â  <p id="modalEmpty" class="text-center text-gray-400 text-sm hidden">Tidak ada jadwal aktif.</p>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  const API_URL = 'https://sil-lab-backend.vercel.app/api'; 
Â  Â  Â  Â  
Â  Â  Â  Â  // Penggantian alert/confirm dengan logging console (Sesuai panduan)
Â  Â  Â  Â  const customAlert = (message) => {
Â  Â  Â  Â  Â  Â  console.log("Aksi Notifikasi:", message);
Â  Â  Â  Â  Â  Â  // Implementasi UI modal/toast nyata jika perlu
Â  Â  Â  Â  Â  Â  // Di sini kita hanya menggunakan window.alert untuk interaksi
Â  Â  Â  Â  Â  Â  window.alert(message);
Â  Â  Â  Â  };
Â  Â  Â  Â  const customConfirm = (message) => {
Â  Â  Â  Â  Â  Â  console.log("Aksi Konfirmasi:", message);
Â  Â  Â  Â  Â  Â  return window.confirm(message); // Menggunakan window.confirm untuk interaksi
Â  Â  Â  Â  };
Â  Â  Â  Â  
Â  Â  Â  Â  const token = localStorage.getItem('token');
Â  Â  Â  Â  const user = JSON.parse(localStorage.getItem('user') || '{}');

Â  Â  Â  Â  // Pengecekan Akses
Â  Â  Â  Â  if (!token || user.role !== 'admin') {
Â  Â  Â  Â  Â  Â  customAlert('Akses Ditolak! Anda bukan Admin.');
Â  Â  Â  Â  Â  Â  // FIX 1: Mengubah 'index.html' menjadi '/index.html' untuk URL yang valid.
Â  Â  Â  Â  Â  Â  window.location.href = '/index.html'; 
Â  Â  Â  Â  }

Â  Â  Â  Â  function showTab(tabName) {
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.tab-button').forEach(b => {
Â  Â  Â  Â  Â  Â  Â  Â  b.classList.remove('bg-blue-600', 'text-white');
Â  Â  Â  Â  Â  Â  Â  Â  b.classList.add('text-gray-600', 'hover:bg-gray-100');
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById(`content-${tabName}`).classList.add('active');
Â  Â  Â  Â  Â  Â  const activeBtn = document.getElementById(`tab-${tabName}`);
Â  Â  Â  Â  Â  Â  activeBtn.classList.add('bg-blue-600', 'text-white');
Â  Â  Â  Â  Â  Â  activeBtn.classList.remove('text-gray-600', 'hover:bg-gray-100');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Load data saat tab diaktifkan (khusus untuk Laporan)
Â  Â  Â  Â  Â  Â  if (tabName === 'laporan') {
Â  Â  Â  Â  Â  Â  Â  Â  loadLaporanKerusakan();
Â  Â  Â  Â  Â  Â  } else if (tabName === 'ruangan') {
Â  Â  Â  Â  Â  Â  Â  Â  loadRuangan(); loadRuangOptions();
Â  Â  Â  Â  Â  Â  } else if (tabName === 'peralatan') {
Â  Â  Â  Â  Â  Â  Â  Â  loadPeralatan();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function deleteItem(endpoint, id, confirmMsg, refreshFn) {
Â  Â  Â  Â  Â  Â  if(!customConfirm(confirmMsg)) return;
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/${endpoint}/${id}`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'DELETE',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Authorization': `Bearer ${token}` }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  if(res.ok) { customAlert('Berhasil dihapus!'); refreshFn(); } 
Â  Â  Â  Â  Â  Â  Â  Â  else { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const errorData = await res.json().catch(() => ({ message: 'Gagal menghapus.' }));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  customAlert(errorData.message || 'Gagal menghapus.');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch(e) { customAlert('Error: ' + e.message); }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- JADWAL LOGIC ---
Â  Â  Â  Â  function toggleRepeatInput() {
Â  Â  Â  Â  Â  Â  const isChecked = document.getElementById('is_repeat').checked;
Â  Â  Â  Â  Â  Â  const container = document.getElementById('repeat_input_container');
Â  Â  Â  Â  Â  Â  if (isChecked) container.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  else container.classList.add('hidden');
Â  Â  Â  Â  }

Â  Â  Â  Â  async function loadRuangOptions() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/rooms`, { headers: { 'Authorization': `Bearer ${token}` } });
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error('Gagal memuat opsi ruangan.'); // Periksa status
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  const select = document.getElementById('jadwal_ruang_id');
Â  Â  Â  Â  Â  Â  Â  Â  select.innerHTML = '<option value="">-- Pilih Ruangan --</option>';
Â  Â  Â  Â  Â  Â  Â  Â  if (Array.isArray(data)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(r => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Hanya tampilkan ruangan yang TIDAK Maintenance untuk dijadwalkan
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (r.status !== 'maintenance') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  select.innerHTML += `<option value="${r.id}">${r.nama_ruang}</option>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error loading room options:", e);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('jadwal_ruang_id').innerHTML = '<option value="">Gagal Memuat</option>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function loadAllBookings() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/booking`, { headers: { 'Authorization': `Bearer ${token}` } });
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error('Gagal memuat data peminjaman.'); // Periksa status
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  const tableBody = document.getElementById('adminTableBody');
Â  Â  Â  Â  Â  Â  Â  Â  tableBody.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if(!Array.isArray(data) || data.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tableBody.innerHTML = '<tr><td colspan="4" class="text-center py-4 italic text-gray-400">Belum ada data</td></tr>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // --- SORTING (SOLUSI UTAMA) ---
Â  Â  Â  Â  Â  Â  Â  Â  data.sort((a, b) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Prioritas 1: Status Pending di atas
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (a.status === 'pending' && b.status !== 'pending') return -1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (a.status !== 'pending' && b.status === 'pending') return 1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Prioritas 2: Waktu terbaru di atas
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return new Date(b.waktu_mulai) - new Date(a.waktu_mulai);
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let statusColor = 'text-yellow-600 bg-yellow-100';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let rowBg = item.status === 'pending' ? 'bg-yellow-50 border-l-4 border-yellow-400' : 'hover:bg-gray-50 border-l-4 border-transparent';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(item.status === 'disetujui') statusColor = 'text-green-600 bg-green-100';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(item.status === 'ditolak') statusColor = 'text-red-600 bg-red-100';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const actions = item.status === 'pending' 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `<div class="flex justify-center space-x-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="updateStatus('${item.id}', 'disetujui')" class="bg-green-500 text-white px-2 py-1 rounded shadow hover:bg-green-600 text-xs font-bold">TERIMA</button> 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="updateStatus('${item.id}', 'ditolak')" class="bg-red-500 text-white px-2 py-1 rounded shadow hover:bg-red-600 text-xs font-bold">TOLAK</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>` 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const btnHapus = `<button onclick="deleteItem('booking', '${item.id}', 'Hapus jadwal ini?', loadAllBookings)" class="text-gray-400 hover:text-red-500 text-lg ml-2" title="Hapus Permanen">&times;</button>`;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const row = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr class="${rowBg} transition duration-150 border-b">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-bold text-gray-800">${item.tujuan_peminjaman}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs text-gray-500 flex items-center gap-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${item.users?.nama || 'Admin'} (${item.users?.role || 'System'})
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4 text-xs">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-semibold text-blue-600 mb-1">ğŸ“ ${item.ruangan?.nama_ruang || 'Unknown'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>ğŸ“… ${new Date(item.waktu_mulai).toLocaleString()}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-gray-400">s/d ${new Date(item.waktu_selesai).toLocaleString()}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="${statusColor} px-2 py-1 rounded text-xs font-bold border border-opacity-20 uppercase tracking-wide">${item.status}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${actions} ${btnHapus}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tableBody.innerHTML += row;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error loading bookings:", e);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('adminTableBody').innerHTML = '<tr><td colspan="4" class="text-center py-4 italic text-red-500">Gagal memuat data peminjaman. Error: ' + e.message + '</td></tr>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function handleTambahJadwal(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const isRepeat = document.getElementById('is_repeat').checked;
Â  Â  Â  Â  Â  Â  const repeatCount = document.getElementById('repeat_count').value;

Â  Â  Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  Â  Â  ruang_id: document.getElementById('jadwal_ruang_id').value,
Â  Â  Â  Â  Â  Â  Â  Â  waktu_mulai: new Date(document.getElementById('jadwal_mulai').value).toISOString(),
Â  Â  Â  Â  Â  Â  Â  Â  waktu_selesai: new Date(document.getElementById('jadwal_selesai').value).toISOString(),
Â  Â  Â  Â  Â  Â  Â  Â  tujuan_peminjaman: document.getElementById('jadwal_tujuan').value,
Â  Â  Â  Â  Â  Â  Â  Â  is_repeat: isRepeat,
Â  Â  Â  Â  Â  Â  Â  Â  repeat_count: isRepeat ? parseInt(repeatCount) : 1
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const btn = e.target.querySelector('button');
Â  Â  Â  Â  Â  Â  const oldText = btn.innerText;
Â  Â  Â  Â  Â  Â  btn.innerText = 'Memproses...'; btn.disabled = true;

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/booking/admin`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  const r = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  if(!res.ok) throw new Error(r.error || JSON.stringify(r));
Â  Â  Â  Â  Â  Â  Â  Â  customAlert(r.message); e.target.reset(); 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('repeat_input_container').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  loadAllBookings();
Â  Â  Â  Â  Â  Â  } catch(err) { customAlert('Gagal: ' + err.message); }
Â  Â  Â  Â  Â  Â  finally { btn.innerText = oldText; btn.disabled = false; }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function updateStatus(id, status) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/booking/${id}/status`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'PATCH',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ status })
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  if(res.ok) customAlert(`Peminjaman berhasil di${status}!`);
Â  Â  Â  Â  Â  Â  Â  Â  else customAlert('Gagal memperbarui status peminjaman.');
Â  Â  Â  Â  Â  Â  } catch(e) { customAlert('Error: ' + e.message); }
Â  Â  Â  Â  Â  Â  loadAllBookings();
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- RUANGAN & MAINTENANCE ---
Â  Â  Â  Â  async function loadRuangan() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/rooms`, { headers: { 'Authorization': `Bearer ${token}` } });
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error('Gagal memuat data ruangan.'); // Periksa status
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  const tbody = document.getElementById('table-ruangan-body');
Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '';

Â  Â  Â  Â  Â  Â  Â  Â  if(!Array.isArray(data) || data.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '<tr><td colspan="3" class="text-center py-4 italic text-gray-400">Tidak ada data ruangan.</td></tr>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isMtc = item.status === 'maintenance';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const statusBadge = isMtc 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `<span class="bg-orange-100 text-orange-700 px-2 py-1 rounded text-xs font-bold border border-orange-200">ğŸ› ï¸ MAINTENANCE</span>`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : `<span class="bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold border border-green-200">âœ… TERSEDIA</span>`;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const btnMtc = isMtc
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `<button onclick="setMaintenance('${item.id}', 'tersedia')" class="bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600 shadow">Aktifkan</button>`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : `<button onclick="setMaintenance('${item.id}', 'maintenance')" class="bg-orange-400 text-white px-2 py-1 rounded text-xs hover:bg-orange-500 shadow">Maintenance</button>`;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const row = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr class="hover:bg-gray-50 border-b">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-bold text-gray-800">${item.nama_ruang}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs text-gray-500">${item.lokasi} â€¢ Kap: ${item.kapasitas}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6">${statusBadge}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6 text-center space-x-2 flex justify-center items-center mt-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="showRoomSchedule('${item.id}', '${item.nama_ruang}')" class="text-blue-600 hover:text-blue-800 text-xs font-medium underline">Jadwal</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${btnMtc}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteItem('rooms', '${item.id}', 'Hapus ruangan ${item.nama_ruang}?', loadRuangan)" class="text-red-500 hover:text-red-700 text-lg" title="Hapus">&times;</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML += row;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error loading rooms:", e);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('table-ruangan-body').innerHTML = '<tr><td colspan="3" class="text-center py-4 italic text-red-500">Gagal memuat data ruangan. Error: ' + e.message + '</td></tr>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function setMaintenance(id, newStatus) {
Â  Â  Â  Â  Â  Â  const msg = newStatus === 'maintenance' ? 'Set ruangan ini ke Maintenance? (Tidak bisa dipinjam)' : 'Aktifkan kembali ruangan ini?';
Â  Â  Â  Â  Â  Â  if(!customConfirm(msg)) return;
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/rooms/${id}/status`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'PATCH', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }, body: JSON.stringify({ status: newStatus })
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  if(res.ok) { customAlert('Status berhasil diubah!'); loadRuangan(); loadRuangOptions(); } 
Â  Â  Â  Â  Â  Â  Â  Â  else { customAlert('Gagal mengubah status'); }
Â  Â  Â  Â  Â  Â  } catch(e) { customAlert('Error: ' + e.message); }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function handleTambahRuang(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  Â  Â  nama_ruang: document.getElementById('nama_ruang').value,
Â  Â  Â  Â  Â  Â  Â  Â  kapasitas: document.getElementById('kapasitas').value,
Â  Â  Â  Â  Â  Â  Â  Â  lokasi: document.getElementById('lokasi').value
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await fetch(`${API_URL}/rooms`, { method: 'POST', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }, body: JSON.stringify(payload) });
Â  Â  Â  Â  Â  Â  Â  Â  customAlert('Sukses!'); e.target.reset(); loadRuangan(); loadRuangOptions();
Â  Â  Â  Â  Â  Â  } catch(e) { customAlert('Gagal menambah ruangan'); }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- PERALATAN ---
Â  Â  Â  Â  async function loadPeralatan() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/equipment`, { headers: { 'Authorization': `Bearer ${token}` } });
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error('Gagal memuat data peralatan.'); // Periksa status
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  const tbody = document.getElementById('table-peralatan-body');
Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // FIX 3: Memastikan data adalah array sebelum forEach
Â  Â  Â  Â  Â  Â  Â  Â  if (!Array.isArray(data) || data.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '<tr><td colspan="5" class="text-center py-4 italic text-gray-400">Tidak ada data peralatan.</td></tr>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const row = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr class="hover:bg-gray-50 border-b">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6 font-medium">${item.nama_alat}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6 text-gray-500">${item.kategori}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6 text-center font-bold">${item.jumlah_total}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6 text-center"><span class="bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs">${item.kondisi}</span></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-6 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteItem('equipment', '${item.id}', 'Hapus alat ${item.nama_alat}?', loadPeralatan)" class="text-red-500 hover:text-red-700 text-xs font-bold">Hapus</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML += row;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error loading equipment:", e);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('table-peralatan-body').innerHTML = '<tr><td colspan="5" class="text-center py-4 italic text-red-500">Gagal memuat data peralatan. Error: ' + e.message + '</td></tr>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  async function handleTambahPeralatan(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  Â  Â  nama_alat: document.getElementById('nama_alat').value,
Â  Â  Â  Â  Â  Â  Â  Â  kategori: document.getElementById('kategori').value,
Â  Â  Â  Â  Â  Â  Â  Â  jumlah_total: document.getElementById('jumlah_total').value,
Â  Â  Â  Â  Â  Â  Â  Â  kondisi: document.getElementById('kondisi').value
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/equipment`, { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST', 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }, 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(payload) 
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error('Gagal menyimpan alat.');
Â  Â  Â  Â  Â  Â  Â  Â  customAlert('Sukses!'); e.target.reset(); loadPeralatan();
Â  Â  Â  Â  Â  Â  } catch(e) { customAlert('Gagal: ' + e.message); }
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  // --- LAPORAN KERUSAKAN BARU ---
Â  Â  Â  Â  async function loadLaporanKerusakan() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/reports`, { headers: { 'Authorization': `Bearer ${token}` } });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // FIX 2: Tambahkan pemeriksaan status respons sebelum parsing JSON
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const errorText = await res.text();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Status ${res.status}. ${errorText.substring(0, 100)}...`);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  const tbody = document.getElementById('table-laporan-body');
Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if(!Array.isArray(data) || data.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '<tr><td colspan="4" class="text-center py-4 italic text-gray-400">Tidak ada laporan kerusakan.</td></tr>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Prioritas: Laporan 'pending' di atas
Â  Â  Â  Â  Â  Â  Â  Â  data.sort((a, b) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (a.status === 'pending' && b.status !== 'pending') return -1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (a.status !== 'pending' && b.status === 'pending') return 1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return new Date(b.tanggal_lapor) - new Date(a.tanggal_lapor);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let statusColor = 'text-red-600 bg-red-100';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(item.status === 'resolved') statusColor = 'text-green-600 bg-green-100';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isPending = item.status === 'pending';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const rowBg = isPending ? 'bg-red-50 border-l-4 border-red-400' : 'hover:bg-gray-50 border-l-4 border-transparent';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const actions = isPending
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `<button onclick="updateLaporanStatus('${item.id}', 'resolved')" class="bg-green-500 text-white px-2 py-1 rounded shadow hover:bg-green-600 text-xs font-bold mr-2">SELESAI</button>`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const row = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr class="${rowBg} transition duration-150 border-b">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-bold text-gray-800">${item.users?.nama || 'Pengguna Tidak Dikenal'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs text-gray-500">${new Date(item.tanggal_lapor).toLocaleString()}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-semibold text-red-700">${item.equipment?.nama_alat || 'Ruangan: ' + (item.ruangan?.nama_ruang || 'N/A')}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs text-gray-600 italic mt-1 max-w-lg">${item.deskripsi_kerusakan}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="${statusColor} px-2 py-1 rounded text-xs font-bold border border-opacity-20 uppercase tracking-wide">${item.status}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 px-4 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${actions}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteItem('reports', '${item.id}', 'Hapus laporan ini?', loadLaporanKerusakan)" class="text-gray-400 hover:text-red-500 text-lg ml-2" title="Hapus Permanen">&times;</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML += row;
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error loading reports:", e);
Â  Â  Â  Â  Â  Â  Â  Â  // Tampilkan pesan error yang lebih informatif di UI
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('table-laporan-body').innerHTML = '<tr><td colspan="4" class="text-center py-4 italic text-red-500">Gagal memuat data laporan kerusakan. Error: ' + e.message + '</td></tr>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function updateLaporanStatus(id, status) {
Â  Â  Â  Â  Â  Â  const msg = `Tandai laporan ini sebagai '${status}'?`;
Â  Â  Â  Â  Â  Â  if(!customConfirm(msg)) return;
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/reports/${id}/status`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'PATCH',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ status })
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  if(res.ok) customAlert('Status laporan berhasil diperbarui!');
Â  Â  Â  Â  Â  Â  Â  Â  else customAlert('Gagal memperbarui status laporan.');
Â  Â  Â  Â  Â  Â  } catch(e) { customAlert('Error: ' + e.message); }
Â  Â  Â  Â  Â  Â  loadLaporanKerusakan();
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- MODAL ---
Â  Â  Â  Â  function toggleModal() { document.getElementById('scheduleModal').classList.toggle('hidden'); }
Â  Â  Â  Â  async function showRoomSchedule(roomId, roomName) {
Â  Â  Â  Â  Â  Â  document.getElementById('modalRoomName').innerText = `Jadwal: ${roomName}`;
Â  Â  Â  Â  Â  Â  const list = document.getElementById('modalScheduleList');
Â  Â  Â  Â  Â  Â  const empty = document.getElementById('modalEmpty');
Â  Â  Â  Â  Â  Â  list.innerHTML = '<li class="text-center text-gray-400">Loading...</li>';
Â  Â  Â  Â  Â  Â  empty.classList.add('hidden');
Â  Â  Â  Â  Â  Â  toggleModal();

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/booking/schedule`, { headers: { 'Authorization': `Bearer ${token}` } });
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error('Gagal memuat jadwal.');
Â  Â  Â  Â  Â  Â  Â  Â  const schedules = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  const roomSched = schedules.filter(s => s.ruang_id === roomId);
Â  Â  Â  Â  Â  Â  Â  Â  roomSched.sort((a, b) => new Date(a.waktu_mulai) - new Date(b.waktu_mulai));

Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  if(roomSched.length === 0) { empty.classList.remove('hidden'); } 
Â  Â  Â  Â  Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  roomSched.forEach(s => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const start = new Date(s.waktu_mulai).toLocaleString();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const end = new Date(s.waktu_selesai).toLocaleTimeString();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML += `<li class="bg-blue-50 p-2 rounded border-l-4 border-blue-500 text-gray-700"><span class="font-bold block">${start}</span> s/d ${end}</li>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = `<li class="text-center text-red-500">Gagal memuat: ${e.message}</li>`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function logout() { localStorage.clear(); window.location.href = '/index.html'; }

Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  // Initial load for the default tab (peminjaman)
Â  Â  Â  Â  Â  Â  loadAllBookings(); loadRuangan(); loadPeralatan(); loadRuangOptions();
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById('form-tambah-jadwal').addEventListener('submit', handleTambahJadwal);
Â  Â  Â  Â  Â  Â  document.getElementById('form-tambah-ruang').addEventListener('submit', handleTambahRuang);
Â  Â  Â  Â  Â  Â  document.getElementById('form-tambah-peralatan').addEventListener('submit', handleTambahPeralatan);
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>